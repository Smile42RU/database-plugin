DROP TABLE IF EXISTS archi_plugin CASCADE;
DROP TABLE IF EXISTS bendpoints CASCADE;
DROP TABLE IF EXISTS database_version CASCADE;
DROP TABLE IF EXISTS elements CASCADE;
DROP TABLE IF EXISTS elements_in_model CASCADE;
DROP TABLE IF EXISTS folders CASCADE;
DROP TABLE IF EXISTS folders_in_model CASCADE;
DROP TABLE IF EXISTS images CASCADE;
DROP TABLE IF EXISTS models CASCADE;
DROP TABLE IF EXISTS properties CASCADE;
DROP TABLE IF EXISTS relationships CASCADE;
DROP TABLE IF EXISTS relationships_in_model CASCADE;
DROP TABLE IF EXISTS views CASCADE;
DROP TABLE IF EXISTS views_connections CASCADE;
DROP TABLE IF EXISTS views_in_model CASCADE;
DROP TABLE IF EXISTS views_objects CASCADE;

CREATE TABLE bendpoints (
  parent_id      varchar(50) NOT NULL, 
  parent_version int4 NOT NULL, 
  rank           int4 NOT NULL, 
  start_x        int4 NOT NULL, 
  start_y        int4 NOT NULL, 
  end_x          int4 NOT NULL, 
  end_y          int4 NOT NULL, 
  PRIMARY KEY (parent_id, 
  parent_version, 
  rank));
CREATE TABLE database_version (
  archi_plugin varchar(50) NOT NULL, 
  version      int4 NOT NULL);
CREATE TABLE elements (
  id            varchar(50) NOT NULL, 
  version       int4 NOT NULL, 
  class         varchar(50) NOT NULL, 
  name          varchar(1024) NOT NULL, 
  documentation text NOT NULL, 
  type          varchar(3), 
  created_by    varchar(30) NOT NULL, 
  created_on    timestamp NOT NULL, 
  checkedin_by  varchar(30), 
  checkedin_on  timestamp, 
  deleted_by    varchar(30), 
  deleted_on    timestamp, 
  checksum      varchar(50) NOT NULL, 
  PRIMARY KEY (id, 
  version));
CREATE TABLE elements_in_model (
  cin_id           SERIAL NOT NULL, 
  element_id       varchar(50) NOT NULL, 
  element_version  int4 NOT NULL, 
  parent_folder_id varchar(50) NOT NULL, 
  model_id         varchar(50) NOT NULL, 
  model_version    int4 NOT NULL, 
  rank             int4 NOT NULL, 
  PRIMARY KEY (cin_id));
CREATE TABLE folders (
  id            varchar(50) NOT NULL, 
  version       int4 NOT NULL, 
  type          int4 NOT NULL, 
  root_type     int4 NOT NULL, 
  name          varchar(1024) NOT NULL, 
  documentation text NOT NULL, 
  created_by    varchar(30), 
  created_on    timestamp, 
  checksum      varchar(50) NOT NULL, 
  PRIMARY KEY (id, 
  version));
CREATE TABLE folders_in_model (
  fin_id           SERIAL NOT NULL, 
  folder_id        varchar(50) NOT NULL, 
  folder_version   int4 NOT NULL, 
  parent_folder_id varchar(50), 
  model_id         varchar(50) NOT NULL, 
  model_version    int4 NOT NULL, 
  rank             int4 NOT NULL, 
  PRIMARY KEY (fin_id));
CREATE TABLE images (
  path     varchar(50) NOT NULL, 
  image    bytea NOT NULL, 
  checksum varchar(50) NOT NULL, 
  PRIMARY KEY (path));
CREATE TABLE models (
  id           varchar(50) NOT NULL, 
  version      int4 NOT NULL, 
  name         varchar(1024) NOT NULL, 
  note         text, 
  purpose      text, 
  created_by   varchar(30) NOT NULL, 
  created_on   timestamp(7) NOT NULL, 
  checkedin_by varchar(30), 
  checkedin_on timestamp, 
  deleted_by   varchar(30), 
  deleted_on   timestamp, 
  PRIMARY KEY (id, 
  version));
CREATE TABLE properties (
  parent_id      varchar(50) NOT NULL, 
  parent_version int4 NOT NULL, 
  rank           int4 NOT NULL, 
  name           varchar(1024) NOT NULL, 
  value          text NOT NULL, 
  PRIMARY KEY (parent_id, 
  parent_version, 
  rank));
CREATE TABLE relationships (
  id            varchar(50) NOT NULL, 
  version       int4 NOT NULL, 
  class         varchar(50) NOT NULL, 
  name          varchar(1024) NOT NULL, 
  documentation text NOT NULL, 
  source_id     varchar(50), 
  target_id     varchar(50), 
  strength      varchar(20), 
  access_type   int4, 
  created_by    varchar(30) NOT NULL, 
  created_on    timestamp NOT NULL, 
  checkedin_by  varchar(30), 
  checkedin_on  timestamp, 
  deleted_by    varchar(30), 
  deleted_on    timestamp, 
  checksum      varchar(50) NOT NULL, 
  PRIMARY KEY (id, 
  version));
CREATE TABLE relationships_in_model (
  cin_id               SERIAL NOT NULL, 
  relationship_id      varchar(50) NOT NULL, 
  relationship_version int4 NOT NULL, 
  parent_folder_id     varchar(50) NOT NULL, 
  model_id             varchar(50) NOT NULL, 
  model_version        int4 NOT NULL, 
  rank                 int4 NOT NULL, 
  PRIMARY KEY (cin_id));
CREATE TABLE views (
  id                     varchar(50) NOT NULL, 
  version                int4 NOT NULL, 
  class                  varchar(50) NOT NULL, 
  name                   varchar(1024) NOT NULL, 
  documentation          text NOT NULL, 
  hint_content           text, 
  hint_title             varchar(1024), 
  created_by             varchar(30) NOT NULL, 
  created_on             timestamp NOT NULL, 
  background             int4, 
  connection_router_type int4 NOT NULL, 
  viewpoint              varchar(30), 
  screenshot             bytea, 
  checksum               varchar(50) NOT NULL, 
  PRIMARY KEY (id, 
  version));
CREATE TABLE views_connections (
  id               varchar(50) NOT NULL, 
  version          int4 NOT NULL, 
  container_id     varchar(50) NOT NULL, 
  view_id          varchar(50) NOT NULL, 
  view_version     int4 NOT NULL, 
  class            varchar(50) NOT NULL, 
  name             varchar(1024), 
  documentation    text, 
  is_locked        int2, 
  line_color       varchar(7), 
  line_width       int4, 
  font             varchar(150), 
  font_color       varchar(7), 
  relationship_id  varchar(50), 
  source_object_id varchar(50), 
  target_object_id varchar(50), 
  type             int4, 
  rank             int4 NOT NULL, 
  checksum         varchar(50) NOT NULL, 
  PRIMARY KEY (id, 
  version, 
  container_id));
CREATE TABLE views_in_model (
  vin_id           SERIAL NOT NULL, 
  view_id          varchar(50) NOT NULL, 
  view_version     int4 NOT NULL, 
  parent_folder_id varchar(50) NOT NULL, 
  model_id         varchar(50) NOT NULL, 
  model_version    int4 NOT NULL, 
  rank             int4, 
  PRIMARY KEY (vin_id));
CREATE TABLE views_objects (
  id             varchar(50) NOT NULL, 
  version        int4 NOT NULL, 
  container_id   varchar(50) NOT NULL, 
  view_id        varchar(50) NOT NULL, 
  view_version   int4 NOT NULL, 
  class          varchar(50) NOT NULL, 
  element_id     varchar(50), 
  diagram_ref_id varchar(50), 
  border_color   varchar(7), 
  border_type    int4, 
  content        text, 
  documentation  text, 
  hint_content   text, 
  hint_title     varchar(1024), 
  is_locked      int2, 
  image_path     varchar(50), 
  image_position int4, 
  line_color     varchar(7), 
  line_width     int4, 
  fill_color     varchar(7), 
  font           varchar(150), 
  font_color     varchar(7), 
  name           varchar(1024), 
  notes          text, 
  text_alignment int4, 
  text_position  int4, 
  type           int4, 
  x              int4, 
  y              int4, 
  width          int4, 
  height         int4, 
  rank           int4 NOT NULL, 
  checksum       varchar(50) NOT NULL, 
  PRIMARY KEY (id, 
  version, 
  container_id));

INSERT INTO database_version (archi_plugin, version) VALUES('DatabasePlugin', 201);